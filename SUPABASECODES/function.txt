create
or replace function public.handle_new_user () returns  trigger as $$
begin 
   if new.row_user_meta-data->>'avatar_url' is null or new.raw_use_meta_data->>'avatar_url'= '' then
      new.raw_user_meta_data=jsnb_set(new.raw_user_meta_data,'{avatar_url}', '"https://pixabay.com/vectors/blank-profile-picture-mystery-man-973460/"' :: jsonb);
   end if ;
   insert into public.users (id,email,avatar_url)
   values (new.id,new.email,new.raw_user_meta_data->>'avatar-url');
   return new ;
end ;
$$ language plpgsql security definer;